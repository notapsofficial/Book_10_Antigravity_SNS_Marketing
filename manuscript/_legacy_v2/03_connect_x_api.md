# Part 3｜Xを実行環境としてつなぐ（最初の技術実装）

## 第1章：2026年のAPI環境と選択

### 1-1. なぜ X (Twitter) API なのか

#### 思考のプロセス：学習コストと実装ハードル

2026年現在、SNSのプラットフォームは多様化しています。
TikTok, Instagram, YouTube Shorts など、動画コンテンツが主流の時代において、なぜあえて「オワコン」とも揶揄される X (旧Twitter) のAPIを選択するのか。
ここには、流行り廃りではない、エンジニアリング的な合理性があります。

**比較検討：他のプラットフォーム**
*   **YouTube / TikTok**:
    *   **課題**: 自動化するには「動画生成（レンダリング）」が必要です。これには高い計算リソース（GPU）と、複雑な編集ロジックが必要です。
    *   **結論**: 「最初の実験場」としてはハードルが高すぎる。
*   **Instagram / Threads**:
    *   **課題**: APIの仕様が頻繁に変わり、かつMeta社の審査（Review）が非常に厳格です。個人開発者が気軽にBotを作るには障壁があります。

対して X は、基本的に**「テキスト（文字列）」**を扱うプラットフォームです。
文字列操作（String Manipulation）は、プログラミングにおいて最も基本的で、制御しやすい処理です。
Pythonなどのスクリプト言語から制御しやすく、システムとしてのSNS運用を学ぶための**「Hello World」的な環境**として、X以上に適した場所はまだ存在しません。

### 1-2. コストについて（Basic Tierの現状）

#### 思考のプロセス：投資対効果（ROI）の計算

実装に入る前に、避けられない「コスト」の話をします。
現在の X API は無料枠（Free Tier）の制限が厳しく、書き込み制限（月1500件）や読み取り制限があります。
安定したシステム運用のためには、**Basic Tier（月額100ドル程度）** への加入が事実上の前提となります。

**迷い**: 「月100ドル（約1.5万円）は高いのではないか？」
私も最初はそう思いました。NetflixやSpotifyの何倍もの価格です。

**判断のロジック**:
しかし、これを「サブスクリプション」ではなく**「設備投資」**として捉え直しました。
もし、広報担当のアルバイトを雇ったとしたらどうでしょう？
時給1000円だとしても、たった15時間で1.5万円に達します。
「24時間365日、文句も言わずに稼働し続ける広報システム」の維持費として見た場合、この金額は破格の安さになります。

もちろん、最初はFree Tierでコードの動作確認だけ行い、「これならいける」と確信してから課金することをお勧めします。

## 第2章：Developer Portal 設定ガイド

### 2-1. Project と App の作成

開発者ポータル（Twitter Developer Portal）では、以下の階層構造で管理されます。
UIは頻繁に変更されるため、スクリーンショットではなく「概念」を理解してください。

1.  **Project (プロジェクト)**: 全体の大枠（フォルダのようなもの）。
2.  **App (アプリ)**: 具体的なボットやツール。APIキーはこの単位で発行されます。

### 2-2. 権限設定（ここが重要です）

#### 失敗の共有：Read Only の罠

私が最初にハマったのが、この権限設定でした。
Appを作成した直後は、デフォルトで **`Read Only`**（読み取り専用）になっています。
このままコードを書いて実行すると、認証は通るのに投稿だけ失敗する（403 Forbidden）という、原因が分かりにくいエラーに悩みます。

必ず最初に以下の設定を変更してください。
1.  **App permissions**: `Read and Write` を選択。
2.  **Type of App**: `Web App, Automated App or Bot` を選択。

### 2-3. キーの取得と保管

`Keys and Tokens` タブで、必要な認証情報を取得します。
ここでも、セキュリティに対する意識（マインドセット）が問われます。

## 第3章：セキュリティ対策（安全な実装のために）

### 3-1. キーをコードに直接書かない

#### 思考のプロセス：なぜ「動けばいい」ではダメなのか

初心者がやりがちな実装がこれです。
```python
# 悪い例
api_key = "xhqo...." # コードに直接書いている
```
これでも動きます。しかし、これをGitHubにPushした瞬間、あなたのキーは世界中に公開され、悪意あるBotに乗っ取られるリスクがあります。
「自分だけが見るプライベートリポジトリだから大丈夫」という油断が、最大の脆弱性です。

これを防ぐための標準的な手法（ベストプラクティス）が、**環境変数（Environment Variables）**です。
コードと設定（秘密情報）を分離する。
これは、The Twelve-Factor App などでも推奨される、モダンなアプリケーション開発の基本原則です。

#### Tips: AIに「事前に頼む」という防衛策
コード生成をAntigravityに依頼する際、プロンプトでこう伝えてください。
**「セキュリティ上の懸念がないように、フォルダやファイルを管理する構成にしてください」**

そうすることで、AIはあなたの意図を汲み取り、最初からキーを別ファイル（.envなど）に分ける安全な実装パターンを提案してくれます。
「うっかり事故」を防ぐためにも、AIをセキュリティの監視役（Security Linter）として巻き込んでしまいましょう。

## 第4章：Antigravityに接続を依頼する

### 4-1. コードは書かなくていい

ここから先は、あなたがコードを書く必要はありません。
Part 0 でお伝えした通り、Antigravity (Google) の Workbench は、ブラウザ操作もコード実行も一元管理できる強力な環境です。

ここまで準備してきた「API情報」と「やりたいこと」を伝えるだけで、実装はAntigravityが担当します。
あなたは「コーダー」ではなく「発注者」としてのスキルを使ってください。

### 4-2. 依頼のためのプロンプト

Antigravityに対して、以下のように指示を出してください。

```markdown
# Task
X API (Basic Tier) への接続テストをお願いします。

# Context
- APIキー等の情報は、同階層の `.env` ファイルに記述してあります。
- `tweepy` ライブラリを使用してください。
- 投稿内容は "Hello, Antigravity System! [timestamp]" としてください。

# Constraints
- 事前に `.env` を読み込む実装にしてください。
- コードを生成し、実行して結果を教えてください。
```

### 4-3. 実行結果の確認

指示を出すと、Antigravityは自動的にPythonコードを生成し、環境構築（ライブラリのインストール等）を行った上で、スクリプトを実行します。

画面上に `Successfully posted` や `ID: xxxxx` といった実行結果が表示されれば完了です。
もしエラーが出た場合も、「このエラーを直して」と伝えるだけで、Antigravityが修正を行ってくれます。

これで、あなたのAntigravity環境から、世界（X）へのパスが開通しました。
おめでとうございます。
これは小さな「Hello World」ですが、あなたの代わりにシステムが世界に干渉した、大きな一歩です。

## 第5章：この章のまとめ

### 確認事項
*   [x] X を選んだ理由（テキストベース・APIの扱いやすさ）を理解した。
*   [x] Basic Tier のコストを「設備投資」として捉える判断をした。
*   [x] 環境変数（.env）を使って、キーを安全に管理する重要性を理解した。
*   [x] Antigravity に実装を依頼し、最初の投稿を成功させた。

接続という一番ハードルが高い部分はこれで完了です。
次章では、このシステムを運用していくための、具体的で無理のないワークフロー（部長モデル）についてお話しします。
いきなり全自動にするのではなく、人間が介在する安全な運用から始めていきましょう。
